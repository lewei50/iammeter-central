import{b as we,d as ae,N as Se,aU as $e,at as Ee,aj as T,m as R,aB as W,am as oe,aV as De,e as B,aW as Ae,aX as ke,H as Ce,f as Ve,I as p,au as Ie,g as N,aY as Ne,$ as Te,a5 as le,o as $,c as z,y as v,r as V,p as C,q as a,s as q,O as E,n as H,t as S,E as ne,aZ as Be,J as Le,K as Me,a7 as Pe,v as x,ac as Fe,a3 as Oe,L as k,M as se,a2 as Ke,aD as Re,_ as He,C as U,B as Ue,A as We,a4 as qe,aQ as xe,ae as ze}from"./index-CVVgb_0u.js";/* empty css               *//* empty css               */import{c as je}from"./common-9_AlMieT.js";import{e as Ge,f as Je}from"./index-DzYfilnm.js";import{E as Qe}from"./date-picker-x3ikzoQK.js";const Xe=we({valueKey:{type:String,default:"value"},modelValue:{type:[String,Number],default:""},debounce:{type:Number,default:300},placement:{type:ae(String),values:["top","top-start","top-end","bottom","bottom-start","bottom-end"],default:"bottom-start"},fetchSuggestions:{type:ae([Function,Array]),default:Se},popperClass:{type:String,default:""},triggerOnFocus:{type:Boolean,default:!0},selectWhenUnmatched:{type:Boolean,default:!1},hideLoading:{type:Boolean,default:!1},teleported:$e.teleported,highlightFirstItem:{type:Boolean,default:!1},fitInputWidth:{type:Boolean,default:!1},clearable:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},name:String,...Ee(["ariaLabel"])}),Ye={[T]:r=>R(r),[W]:r=>R(r),[oe]:r=>R(r),focus:r=>r instanceof FocusEvent,blur:r=>r instanceof FocusEvent,clear:()=>!0,select:r=>De(r)},re="ElAutocomplete",Ze=B({name:re,inheritAttrs:!1}),et=B({...Ze,props:Xe,emits:Ye,setup(r,{expose:b,emit:l}){const t=r,u=Ae(),g=ke(),m=Ce(),c=Ve("autocomplete"),s=p(),i=p(),L=p(),j=p();let G=!1,M=!1;const f=p([]),n=p(-1),J=p(""),h=p(!1),I=p(!1),_=p(!1),D=Ie(),ue=N(()=>g.style),y=N(()=>(f.value.length>0||_.value)&&h.value),Q=N(()=>!t.hideLoading&&_.value),ie=N(()=>s.value?Array.from(s.value.$el.querySelectorAll("input")):[]),ce=()=>{y.value&&(J.value=`${s.value.$el.offsetWidth}px`)},de=()=>{n.value=-1},X=async e=>{if(I.value)return;const o=d=>{_.value=!1,!I.value&&(U(d)?(f.value=d,n.value=t.highlightFirstItem?0:-1):Ue(re,"autocomplete suggestions must be an array"))};if(_.value=!0,U(t.fetchSuggestions))o(t.fetchSuggestions);else{const d=await t.fetchSuggestions(e,o);U(d)&&o(d)}},Y=Ge(X,t.debounce),pe=e=>{const o=!!e;if(l(W,e),l(T,e),I.value=!1,h.value||(h.value=o),!t.triggerOnFocus&&!e){I.value=!0,f.value=[];return}Y(e)},fe=e=>{var o;m.value||(((o=e.target)==null?void 0:o.tagName)!=="INPUT"||ie.value.includes(document.activeElement))&&(h.value=!0)},ve=e=>{l(oe,e)},ge=e=>{M?M=!1:(h.value=!0,l("focus",e),t.triggerOnFocus&&!G&&Y(String(t.modelValue)))},me=e=>{setTimeout(()=>{var o;if((o=L.value)!=null&&o.isFocusInsideContent()){M=!0;return}h.value&&A(),l("blur",e)})},he=()=>{h.value=!1,l(T,""),l("clear")},Z=async()=>{y.value&&n.value>=0&&n.value<f.value.length?P(f.value[n.value]):t.selectWhenUnmatched&&(l("select",{value:t.modelValue}),f.value=[],n.value=-1)},be=e=>{y.value&&(e.preventDefault(),e.stopPropagation(),A())},A=()=>{h.value=!1},ye=()=>{var e;(e=s.value)==null||e.focus()},_e=()=>{var e;(e=s.value)==null||e.blur()},P=async e=>{l(W,e[t.valueKey]),l(T,e[t.valueKey]),l("select",e),f.value=[],n.value=-1},F=e=>{if(!y.value||_.value)return;if(e<0){n.value=-1;return}e>=f.value.length&&(e=f.value.length-1);const o=i.value.querySelector(`.${c.be("suggestion","wrap")}`),w=o.querySelectorAll(`.${c.be("suggestion","list")} li`)[e],O=o.scrollTop,{offsetTop:te,scrollHeight:K}=w;te+K>O+o.clientHeight&&(o.scrollTop+=K),te<O&&(o.scrollTop-=K),n.value=e,s.value.ref.setAttribute("aria-activedescendant",`${D.value}-item-${n.value}`)},ee=Ne(j,()=>{y.value&&A()});return Te(()=>{ee==null||ee()}),le(()=>{s.value.ref.setAttribute("role","textbox"),s.value.ref.setAttribute("aria-autocomplete","list"),s.value.ref.setAttribute("aria-controls","id"),s.value.ref.setAttribute("aria-activedescendant",`${D.value}-item-${n.value}`),G=s.value.ref.hasAttribute("readonly")}),b({highlightedIndex:n,activated:h,loading:_,inputRef:s,popperRef:L,suggestions:f,handleSelect:P,handleKeyEnter:Z,focus:ye,blur:_e,close:A,highlight:F,getData:X}),(e,o)=>($(),z(a(Re),{ref_key:"popperRef",ref:L,visible:a(y),placement:e.placement,"fallback-placements":["bottom-start","top-start"],"popper-class":[a(c).e("popper"),e.popperClass],teleported:e.teleported,"gpu-acceleration":!1,pure:"","manual-mode":"",effect:"light",trigger:"click",transition:`${a(c).namespace.value}-zoom-in-top`,persistent:"",role:"listbox",onBeforeShow:ce,onHide:de},{content:v(()=>[V("div",{ref_key:"regionRef",ref:i,class:C([a(c).b("suggestion"),a(c).is("loading",a(Q))]),style:q({[e.fitInputWidth?"width":"minWidth"]:J.value,outline:"none"}),role:"region"},[E(a(Je),{id:a(D),tag:"ul","wrap-class":a(c).be("suggestion","wrap"),"view-class":a(c).be("suggestion","list"),role:"listbox"},{default:v(()=>[a(Q)?($(),H("li",{key:0},[S(e.$slots,"loading",{},()=>[E(a(ne),{class:C(a(c).is("loading"))},{default:v(()=>[E(a(Be))]),_:1},8,["class"])])])):($(!0),H(Le,{key:1},Me(f.value,(d,w)=>($(),H("li",{id:`${a(D)}-item-${w}`,key:w,class:C({highlighted:n.value===w}),role:"option","aria-selected":n.value===w,onClick:O=>P(d)},[S(e.$slots,"default",{item:d},()=>[Pe(x(d[e.valueKey]),1)])],10,["id","aria-selected","onClick"]))),128))]),_:3},8,["id","wrap-class","view-class"])],6)]),default:v(()=>[V("div",{ref_key:"listboxRef",ref:j,class:C([a(c).b(),e.$attrs.class]),style:q(a(ue)),role:"combobox","aria-haspopup":"listbox","aria-expanded":a(y),"aria-owns":a(D)},[E(a(Fe),Oe({ref_key:"inputRef",ref:s},a(u),{clearable:e.clearable,disabled:a(m),name:e.name,"model-value":e.modelValue,"aria-label":e.ariaLabel,onInput:pe,onChange:ve,onFocus:ge,onBlur:me,onClear:he,onKeydown:[k(se(d=>F(n.value-1),["prevent"]),["up"]),k(se(d=>F(n.value+1),["prevent"]),["down"]),k(Z,["enter"]),k(A,["tab"]),k(be,["esc"])],onMousedown:fe}),Ke({_:2},[e.$slots.prepend?{name:"prepend",fn:v(()=>[S(e.$slots,"prepend")])}:void 0,e.$slots.append?{name:"append",fn:v(()=>[S(e.$slots,"append")])}:void 0,e.$slots.prefix?{name:"prefix",fn:v(()=>[S(e.$slots,"prefix")])}:void 0,e.$slots.suffix?{name:"suffix",fn:v(()=>[S(e.$slots,"suffix")])}:void 0]),1040,["clearable","disabled","name","model-value","aria-label","onKeydown"])],14,["aria-expanded","aria-owns"])]),_:3},8,["visible","placement","popper-class","teleported","transition"]))}});var tt=He(et,[["__file","autocomplete.vue"]]);const at=We(tt),st={class:"value"},ot=B({__name:"SnSelector",props:{selectedMeter:{type:String,required:!0}},setup(r){const b=p(""),l=qe([{sn:"",name:"",isOnline:!1}]),t=(g,m)=>{const c=l.filter(s=>s.sn.toLowerCase().includes(g.toLowerCase())||s.name!=null&&s.name.toLowerCase().includes(g.toLowerCase()));m(c)},u=async()=>{const g=await je({});g.successful&&l.splice(0,l.length,...g.data)};return le(()=>{u()}),(g,m)=>{const c=ne,s=at;return $(),z(s,{clearable:"","value-key":"sn",modelValue:b.value,"onUpdate:modelValue":m[0]||(m[0]=i=>b.value=i),"fetch-suggestions":t,placeholder:"Select Meter SN"},{prefix:v(()=>[E(c,null,{default:v(()=>[E(a(xe))]),_:1})]),default:v(({item:i})=>[V("div",st,[V("span",{class:C({"online-dot":i.online&&i.bound,"offline-dot":!i.online&&i.bound,"not-bound-dot":!i.bound})},null,2),V("span",{style:q({opacity:i.bound?"1":"0.3",pointerEvents:i.bound?"auto":"none"})},x(i.sn)+" "+x(i.name?`(${i.name})`:""),5)])]),_:1},8,["modelValue"])}}}),dt=ze(ot,[["__scopeId","data-v-b6eb7c1e"]]),pt=B({__name:"DateRangePicker",setup(r){const b=p(""),l=[{text:"Today",value:()=>{const t=new Date;return t.setHours(0,0,0,0),[new Date(t),t]}},{text:"Last week",value:()=>{const t=new Date;t.setHours(0,0,0,0);const u=new Date(t);return u.setDate(u.getDate()-7),[u,t]}},{text:"Last month",value:()=>{const t=new Date;t.setHours(0,0,0,0);const u=new Date(t);return u.setMonth(u.getMonth()-1),[u,t]}}];return(t,u)=>{const g=Qe;return $(),z(g,{modelValue:b.value,"onUpdate:modelValue":u[0]||(u[0]=m=>b.value=m),type:"daterange","unlink-panels":"","range-separator":"To","start-placeholder":"Start Date","end-placeholder":"End Date",shortcuts:l},null,8,["modelValue"])}}});export{dt as S,pt as _};
