import{e as O,I as p,a4 as E,aS as R,o as y,n as x,O as n,y as u,a7 as _,q as D,a8 as H,J as V,K as T,c as $,r as j,a6 as F,x as k,aT as M,ab as I,ae as q}from"./index-CVVgb_0u.js";/* empty css                *//* empty css              *//* empty css               *//* empty css               *//* empty css                        */import{S as A,_ as Q}from"./DateRangePicker.vue_vue_type_script_setup_true_lang-7Q51MUGW.js";import{f as C,a as Y,b as B,p as J}from"./common-9_AlMieT.js";import{E as w}from"./index-UYW-ElF2.js";import{a as K,E as z}from"./index-CsxsiZ4j.js";import{a as G,b as P}from"./index-DzYfilnm.js";import{E as W}from"./index-Dx8dXwis.js";import{v as X}from"./directive-DN3s17fQ.js";import"./date-picker-x3ikzoQK.js";import"./index-CItWWpyQ.js";import"./_Uint8Array-CoH_bIvD.js";const Z={class:"content1-container"},ee={key:0,class:"loading-container"},te=O({__name:"history",setup(ae){const d=p(""),r=p(""),f=p(2),m=p(!1),g=p(!1);E([{sn:"",name:"",isOnline:!1}]);const h=E({title:{text:"History Data"},xAxis:{type:"datetime",title:null},yAxis:{title:null},series:[{name:"Sales",data:[120,200,150,80,70],type:"line"}],tooltip:{shared:!0,formatter:function(){let l=C[f.value].unit;const e=new Date(this.points[0].x);let a=`<b>${Y(e)}</b><br/>`;return this.points.forEach(t=>{a+=`<span style="color:${t.color}">‚óè</span> ${t.series.name}: ${t.y}${l}<br/>`}),a}}}),b=p(!1),L=async()=>{m.value=!0,h.series=[],console.log(d,r,f);try{const[l,e]=r.value&&r.value.length===2?r.value.map(a=>{const t=new Date(a);return`${t.getFullYear()}-${t.getMonth()+1}-${t.getDate()}`}):[null,null];console.log(l,e);const s=await B(d.value,l,e,1,1e3**3,"json");if(s.successful){const a=s.data;if(a.length===0)w.warning("No data available for the selected range."),b.value=!1;else{const t=[];for(let o=0;o<a[0].datas.length;o++)t.push({name:J[o],data:a.map(c=>[new Date(c.time).getTime(),c.datas[o][f.value]]),type:"line",marker:{enabled:!1}});console.log(t),h.series=t,b.value=!0,M(h)}}else w.error(`Failed to fetch history data: ${s.message}`)}catch(l){w.error("Error fetching history data"),console.error("Error fetching history data",l)}finally{m.value=!1}},S=async()=>{g.value=!0;try{const[l,e]=r.value&&r.value.length===2?r.value.map(c=>{const v=new Date(c);return`${v.getFullYear()}-${v.getMonth()+1}-${v.getDate()}`}):[null,null],s=await B(d.value,l,e,1,1e3**3,"csv"),a=new Blob([s],{type:"text/csv"}),t=window.URL.createObjectURL(a),o=document.createElement("a");o.href=t,o.download="history_data.csv",document.body.appendChild(o),o.click(),window.URL.revokeObjectURL(t),document.body.removeChild(o)}catch(l){console.error("Export failed",l)}finally{g.value=!1}};return(l,e)=>{const s=K,a=z,t=G,o=P,c=I,v=W,N=R("highcharts"),U=X;return y(),x(V,null,[n(a,{"separator-icon":D(H)},{default:u(()=>[n(s,{to:"/user/dashboard"},{default:u(()=>e[3]||(e[3]=[_("Home")])),_:1}),n(s,null,{default:u(()=>e[4]||(e[4]=[_("Reports")])),_:1}),n(s,null,{default:u(()=>e[5]||(e[5]=[_("History Data")])),_:1})]),_:1},8,["separator-icon"]),n(v,{justify:"end",my:"4",style:{width:"100%"}},{default:u(()=>[n(A,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=i=>d.value=i)},null,8,["modelValue"]),n(Q,{modelValue:r.value,"onUpdate:modelValue":e[1]||(e[1]=i=>r.value=i)},null,8,["modelValue"]),n(o,{modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=i=>f.value=i),placeholder:"Display Data",style:{"min-width":"150px"}},{default:u(()=>[(y(!0),x(V,null,T(D(C),i=>(y(),$(t,{key:i.index,label:i.label,value:i.index},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),n(c,{type:"primary",onClick:L,disabled:!d.value||m.value},{default:u(()=>e[6]||(e[6]=[_("Query")])),_:1},8,["disabled"]),n(c,{type:"success",onClick:S,loading:g.value,disabled:!d.value||g.value},{default:u(()=>e[7]||(e[7]=[_("Export")])),_:1},8,["loading","disabled"])]),_:1}),j("div",Z,[m.value?F((y(),x("div",ee,null,512)),[[U,m.value]]):k("",!0),b.value&&!m.value?(y(),$(N,{key:1,options:h,class:"chart-container"},null,8,["options"])):k("",!0)])],64)}}}),he=q(te,[["__scopeId","data-v-b15f632a"]]);export{he as default};
